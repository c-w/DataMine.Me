<!doctype html>
<html>
  <head>
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="icon" sizes="16x16 32x32 64x64" href="favicon.ico">

    <title>My readings</title>

    <meta name=viewport content="width=device-width, initial-scale=1">

    <script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">
    <link type="text/css" rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/1.0.16/vue.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.1.0/js.cookie.min.js"></script>

    <link rel="stylesheet" href="./style.css">
  </head>

  <body>
    <div id="page">
      <div v-cloak class="fullscreen {{styling.backgroundColor}}">

        <div id="nav-container" class="navbar-fixed" role="navigation">
          <nav class="{{styling.navbarColor}}">
            <div class="nav-wrapper">
              <ul class="left">
                <li>
                  <div id="filters">
                    <ul id="filters-dropdown" class="dropdown-content">
                      <li v-for="filter in filters"
                          v-bind:class="{'active': filterKey===filter.topic}"
                          class="dropdown-item filter">
                        <a v-on:click="filterKey=filter.topic"
                           href="#{{*filter.uid}}" role="button">
                          <span class="dropdown-label-text">{{*filter.name}}</span>
                          <span v-if="filter.totalPosts"
                                class="badge">{{*filter.totalPosts}}</span>
                          <span v-if="filter.newPosts"
                                class="badge new">{{*filter.newPosts}}</span>
                        </a>
                      </li>
                    </ul>
                    <a data-activates="filters-dropdown"
                       data-constrainwidth="false"
                       data-beloworigin="true"
                       data-alignment="right"
                       class="dropdown-button" href="#!" role="button"
                       id="filters-trigger">
                      <i class="material-icons">filter_list</i>
                    </a>
                  </div>
                </li>

                <li>
                  <div id="search" class="search-form">
                    <div class="input-field">
                      <input v-model="searchKey"
                             role="search"
                             autocomplete="off"
                             debounce="300"
                             type="search"
                             class="search form-control"
                             id="search-input"/>
                      <label for="search-input">
                        <i class="material-icons search">search</i>
                      </label>
                      <i class="material-icons close" role="button" v-on:click="searchKey = ''">close</i>
                    </div>
                  </div>
                </li>
              </ul>
            </div>
          </nav>
        </div>

        <div id="posts" role="main">
          <div class="container">
            <div class="row">
              <div v-for="post in posts
                          | filterBy filterKey in 'topics'
                          | filterBy searchKey in 'title' 'summary'"
                   v-bind:class="{'deemphasize': selectedPostUid && selectedPostUid !== post.uid}"
                   transition="fade"
                   class="post card col s12 hoverable">
                <div class="card-deselect">
                  <a v-if="selectedPostUid === post.uid"
                     v-on:click="selectedPostUid = ''"
                     href="#!" role="button">
                    <i class="material-icons close card-menu">close</i>
                  </a>
                </div>
                <div class="card-block card-content">
                  <h4 class="card-title">{{*post.title}}</h4>
                  <p class="card-text">{{*post.summary}}</p>
                </div>
                <div class="card-block card-action activator">
                  <a v-if="post.url"
                     class="card-link" href="{{*post.url}}">Origin</a>
                  <a v-on:click="selectedPostUid = post.uid"
                     class="card-link" href="#{{*post.uid}}">Permalink</a>
                  <i class="material-icons more-vert card-menu">more_vert</i>
                </div>
                <div class="card-reveal">
                  <h4 class="card-title">{{*post.title}}<i class="material-icons close card-menu">close</i></h4>
                  <p class="card-text">
                    <ul>
                      <li>Date: {{post | displayDate}}</li>
                      <li>Topics: {{post | displayTopics}}</li>
                      <li>Type: {{*post.type}}</li>
                    </ul>
                  <p>
                </div>
              </div>
            </div>
          </div>
        </div>

      </div>
    </div>

    <script src="./page.js"></script>

    <script>
      $(document).ready(function(){
        $('.dropdown-button').each(function() {
          $(this).dropdown();
        });
      });
    </script>
  </body>
</html>
