<!doctype html>
<html>
  <head>
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="icon" sizes="16x16 32x32 64x64" href="favicon.ico">

    <title>My readings</title>

    <meta name=viewport content="width=device-width, initial-scale=1">

    <script type='text/javascript' src='https://code.jquery.com/jquery-1.11.3.min.js'></script>
    <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/Shuffle/3.1.1/jquery.shuffle.modernizr.min.js'></script>
    <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js'></script>
    <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.5/handlebars.min.js'></script>
    <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.17.0/URI.min.js'></script>
    <script type='text/javascript' src='https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.1.0/js.cookie.min.js'></script>
    <script type='text/javascript' src='https://cdn.rawgit.com/c-w/jquery-handlebars-simple/1b8deea/jquery-handlebars-simple.min.js'></script>
    <script type='text/javascript' src='https://cdn.rawgit.com/c-w/jquery-materialize-labelled-dropdown/f301248/jquery-materialize-labelled-dropdown.min.js'></script>
    <script type='text/javascript' src='./page.js'></script>

    <link type='text/css' rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css'>
    <link type='text/css' rel='stylesheet' href='https://fonts.googleapis.com/icon?family=Material+Icons'>
    <link type="text/css" rel="stylesheet" href="./style.css">
  </head>

  <body>
    <script id='helpers' type='text/javascript'>
      Handlebars.registerHelper('stringify', function(json) {
        return JSON.stringify(json);
      });

      Handlebars.registerHelper('permalink', function(el) {
        return window.location.href.split('?')[0] + '?postId=' + el.uid;
      });
    </script>

    <script id='search-template' type='text/handlebars'>
      <form id='search-form'>
        <div class='input-field'>
          <input id='search-input' type='search' required autocomplete='off'>
          <label for='search'><i class='material-icons'>search</i></label>
          <i class='material-icons'>close</i>
        </div>
      </form>
    </script>

    <script id='filters-template' type='text/handlebars'>
      <ul id='filters-dropdown' class='dropdown-content'>
        <li class='dropdown-item filter active' data-group=''>
          <a href='#!' role='button'>
            <span class='dropdown-label-text'>All</span>
            <span class='badge'>{{totalPosts}}</span>
            {{#if newPosts}}<span class='badge new'>{{newPosts}}</span>{{/if}}
          </a>
        </li>
        {{#each filters}}
        <li class='dropdown-item filter' data-group='{{this.name}}'>
          <a href='#!' role='button'>
            <span class='dropdown-label-text'>{{this.name}}</span>
            <span class='badge'>{{this.totalPosts}}</span>
            {{#if newPosts}}<span class='badge new'>{{this.newPosts}}</span>{{/if}}
          </a>
        </li>
        {{/each}}
      </ul>

      <a id='filters-button' class='dropdown-button' href='#!' data-activates='filters-dropdown' role='button'>
        <span class='dropdown-label' data-format='Category: {0}'></span>
        <i class='material-icons right'>arrow_drop_down</i>
      </a>

      <script type='text/javascript'>
        $(document).ready(function() {
          $('#filters-button').labelledDropdown({
            constrain_width: false
          });
        });
      <{{!}}/script>
    </script>

    <script id='sorts-template' type='text/handlebars'>
      <ul id='sorts-dropdown' class='dropdown-content'>
        <li class='dropdown-item sort active' data-reverse='true' data-by='date'>
          <a href='#!' role='button'>
            <span class='dropdown-label-text'>New&rarr;Old
          </a>
        </li>
        <li class='dropdown-item sort' data-reverse='false' data-by='date'>
          <a href='#!' role='button'>
            <span class='dropdown-label-text'>Old&rarr;New</span>
          </a>
        </li>
        <li class='divider'></li>
        <li class='dropdown-item sort' data-reverse='false' data-by='title'>
          <a href='#!' role='button'>
            Title <span class='dropdown-label-text'>A&rarr;Z</span>
          </a>
        </li>
        <li class='dropdown-item sort' data-reverse='true' data-by='title'>
          <a href='#!' role='button'>
            Title <span class='dropdown-label-text'>Z&rarr;A</span>
          </a>
        </li>
      </ul>

      <a id='sorts-button' class='dropdown-button' href='#!' data-activates='sorts-dropdown' role='button'>
        <span class='dropdown-label' data-format='Order: {0}'></span>
        <i class='material-icons right'>arrow_drop_down</i>
      </a>

      <script type='text/javascript'>
        $(document).ready(function() {
          $('#sorts-button').labelledDropdown();
        });
      <{{!}}/script>
    </script>

    <script id='content-template' type='text/handlebars'>
      <div class='container'>
        <div class='row'>
          {{#each this}}
          <div class='card col s12' id='{{this.uid}}' data-groups='{{stringify this.topics}}' data-date='{{this.date}}' data-title='{{this.title}}'>
            <div class='card-content'>
              <span class='card-title'>{{this.title}}</span>
              <p>{{this.summary}}</p>
            </div>
            <div class='card-action'>
              <a href='{{this.url}}'>Origin</a>
              <a href='{{permalink this}}'>Permalink</a>
            </div>
          </div>
          {{/each}}
        </div>
      </div>
    </script>

    <div id='page' class='hide'>
      <div id='nav-container' class='navbar-fixed' role='navigation'>
        <nav id='nav'>
          <div class='nav-wrapper'>
            <ul class='left'>
              <li><div id='search' role='search'></div></li>
            </ul>
            <ul class='right'>
              <li><div id='filters'></div></li>
              <li><div id='sorts'></div></li>
            </ul>
          </div>
        </nav>
      </div>
      <div id='content' role='main'></div>
    </div>
  </body>
</html>
